[TaskFlow]
maa_roguelike = timewindow|5-4|1|0-300|maa_group|none
recruitment = interval|9.5h|2|60-180|maa_group|none
clear_stamina = timewindow|3-3.5|3|0-1800|daily_group|none
clear_materials = timewindow|5-5.5|3|0-1800|daily_group|none
baah_task = timewindow|4.01-4.5|4|60-300|baah_group|none

[TaskPayloads]
maa_roguelike.1 = {"type": "adb_wake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "唤醒屏幕"}}
maa_roguelike.2 = {"type": "adb_keep_awake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "保持屏幕唤醒"}}
maa_roguelike.3 = {"type": "resolution_check", "params": ["1920x1080"], "options": {"log": true, "description": "检查分辨率"}}
maa_roguelike.4 = {"type": "command", "params": ["/root/.cargo/bin/maa roguelike Sami -v"], "options": {"timeout": 80000, "log": true, "realtime_output": true, "keywords": "check", "description": "执行MAA刷肉鸽"}}
maa_roguelike.5 = {"type": "wait", "params": [100], "options": {"log": false, "description": "等待完成"}}

recruitment.1 = {"type": "adb_wake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "唤醒屏幕"}}
recruitment.2 = {"type": "adb_keep_awake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "保持屏幕唤醒"}}
recruitment.3 = {"type": "resolution_check", "params": ["1920x1080"], "options": {"log": true, "description": "检查分辨率"}}
recruitment.4 = {"type": "adb_start_app", "params": ["${ADB_DEVICE}", "com.hypergryph.arknights/com.u8.sdk.U8UnityContext"], "options": {"log": true, "description": "启动明日方舟"}}
recruitment.5 = {"type": "wait", "params": [15], "options": {"log": false, "description": "等待应用启动"}}
recruitment.6 = {"type": "command", "params": ["cd /Task/MAA/Python && /root/.local/bin/uv run python Recruit.py -v"], "options": {"timeout": 300, "log": true, "realtime_output": true, "keywords": "check", "description": "执行公招脚本"}}

clear_stamina.1 = {"type": "adb_wake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "唤醒屏幕"}}
clear_stamina.2 = {"type": "adb_keep_awake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "保持屏幕唤醒"}}
clear_stamina.3 = {"type": "resolution_check", "params": ["1920x1080"], "options": {"log": true, "description": "检查分辨率"}}
clear_stamina.4 = {"type": "adb_start_app", "params": ["${ADB_DEVICE}", "com.hypergryph.arknights/com.u8.sdk.U8UnityContext"], "options": {"log": true, "description": "启动明日方舟"}}
clear_stamina.5 = {"type": "wait", "params": [15], "options": {"log": false, "description": "等待应用启动"}}
clear_stamina.6 = {"type": "command", "params": ["cd /Task/MAA/Python && /root/.local/bin/uv run python EndOneDay.py -v"], "options": {"timeout": 1800, "log": true, "realtime_output": true, "keywords": "check", "description": "执行清理体力脚本"}}

clear_materials.1 = {"type": "adb_wake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "唤醒屏幕"}}
clear_materials.2 = {"type": "adb_keep_awake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "保持屏幕唤醒"}}
clear_materials.3 = {"type": "resolution_check", "params": ["1920x1080"], "options": {"log": true, "description": "检查分辨率"}}
clear_materials.4 = {"type": "adb_start_app", "params": ["${ADB_DEVICE}", "com.hypergryph.arknights/com.u8.sdk.U8UnityContext"], "options": {"log": true, "description": "启动明日方舟"}}
clear_materials.5 = {"type": "wait", "params": [15], "options": {"log": false, "description": "等待应用启动"}}
clear_materials.6 = {"type": "command", "params": ["cd /Task/MAA/Python && /root/.local/bin/uv run python StartOneDay.py -v"], "options": {"timeout": 1800, "log": true, "realtime_output": true, "keywords": "check", "description": "执行清理材料脚本"}}

baah_task.1 = {"type": "adb_wake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "唤醒屏幕"}}
baah_task.2 = {"type": "adb_keep_awake", "params": ["${ADB_DEVICE}"], "options": {"log": true, "description": "保持屏幕唤醒"}}
baah_task.3 = {"type": "resolution_check", "params": ["1280x720"], "options": {"log": true, "description": "检查分辨率"}}
baah_task.4 = {"type": "command", "params": ["cd /Task/BAAH && /root/.local/bin/uv run python3 main.py task.json"], "options": {"timeout": 1800, "log": true, "realtime_output": true, "keywords": "none", "description": "执行BAAH脚本"}}

[TaskKeywords]
recruitment = {"high_value": {"keywords": ["资深干员", "高级资深干员", "六星", "5星", "6星"], "action": "webhook", "webhook_template": "high_value_operator", "title": "MAA公招提醒", "content": "检测到高价值干员！", "tags": ["MAA", "公招", "重要"]}, "complete": {"keywords": ["AllTasksCompleted", "任务完成", "执行完成"], "action": "webhook", "webhook_template": "task_complete", "title": "MAA任务完成", "content": "公招任务执行完成", "tags": ["MAA", "完成"]}, "error": {"keywords": ["任务失败", "Error", "错误", "Exception"], "action": "webhook", "webhook_template": "task_error", "title": "MAA任务错误", "content": "公招任务执行失败，请检查", "tags": ["MAA", "错误", "警告"]}}

clear_stamina = {"complete": {"keywords": ["AllTasksCompleted", "任务完成", "执行完成"], "action": "none"}, "error": {"keywords": ["任务失败", "Error", "错误", "Exception"], "action": "webhook", "webhook_template": "task_error", "title": "体力清理错误", "content": "体力清理任务执行失败", "tags": ["MAA", "错误"]}}

clear_materials = {"complete": {"keywords": ["AllTasksCompleted", "任务完成", "执行完成"], "action": "none"}, "error": {"keywords": ["任务失败", "Error", "错误", "Exception"], "action": "webhook", "webhook_template": "task_error", "title": "材料清理错误", "content": "材料清理任务执行失败", "tags": ["MAA", "错误"]}}

maa_roguelike = {"error": {"keywords": ["连接失败", "ADB连接失败", "游戏崩溃", "Error", "Exception"], "action": "webhook", "webhook_template": "maa_error", "title": "MAA系统错误", "content": "MAA刷肉鸽任务出现错误", "tags": ["MAA", "系统", "错误"]}}

baah_task = {"error": {"keywords": ["错误", "失败", "Exception", "Error"], "action": "webhook", "webhook_template": "baah_error", "title": "BAAH任务错误", "content": "BAAH任务执行失败", "tags": ["BAAH", "错误"]}}

[WebhookTemplates]
high_value_operator = {"url": "${WEBHOOK_DINGDING_URL}", "method": "POST", "headers": {"Content-Type": "application/json"}, "data": {"msgtype": "text", "text": {"content": "{{title}}: {{content}}"}}}

task_complete = {"url": "${WEBHOOK_DINGDING_URL}", "method": "POST", "headers": {"Content-Type": "application/json"}, "data": {"msgtype": "text", "text": {"content": "{{title}}: {{content}}"}}}

task_error = {"url": "${WEBHOOK_DINGDING_URL}", "method": "POST", "headers": {"Content-Type": "application/json"}, "data": {"msgtype": "text", "text": {"content": "⚠️ {{title}}: {{content}}"}}}

maa_error = {"url": "${WEBHOOK_DINGDING_URL}", "method": "POST", "headers": {"Content-Type": "application/json"}, "data": {"msgtype": "text", "text": {"content": "🚨 {{title}}: {{content}}"}}}

baah_error = {"url": "${WEBHOOK_DINGDING_URL}", "method": "POST", "headers": {"Content-Type": "application/json"}, "data": {"msgtype": "text", "text": {"content": "⚠️ {{title}}: {{content}}"}}}

[SystemSettings]
log_level = INFO
max_concurrent_tasks = 3
task_timeout_default = 1800
error_retry_count = 3
error_retry_delay = 60
web_host = 0.0.0.0
web_port = 5000
web_debug = false
web_theme = auto
web_language = auto